{"title":"ä½¿ç”¨ Github Actions è‡ªåŠ¨æ„å»ºéƒ¨ç½² Hexo åšå®¢","slug":"Use-Github-Actions-to-automatically-deploy-Hexo-Blog","date":"2020-11-02T13:36:50.000Z","updated":"2020-11-02T13:36:50.000Z","comments":true,"path":"api/articles/Use-Github-Actions-to-automatically-deploy-Hexo-Blog.json","excerpt":null,"covers":["https://z3.ax1x.com/2020/12/24/rc4kxx.png","https://z3.ax1x.com/2020/12/24/rc4Mid.png","https://z3.ax1x.com/2020/12/24/rc4UoQ.png"],"content":"<h2 id=\"ä»‹ç»\"><a href=\"#ä»‹ç»\" class=\"headerlink\" title=\"ä»‹ç»\"></a>ä»‹ç»</h2><p>è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹ä½¿ç”¨ GitHub Actions ä¸€æ­¥ä¸€æ­¥å®ç° <a href=\"https://hexo.io/\">Hexo Blog</a> è‡ªåŠ¨åŒ–æ„å»ºéƒ¨ç½²åˆ° GitHub Pages çš„æµç¨‹ã€‚</p>\n<p><a href=\"https://docs.github.com/cn/free-pro-team@latest/actions\">GitHub Actions</a> æ˜¯ç±»ä¼¼äº <a href=\"https://travis-ci.org/\">Travis CI</a> ã€ <a href=\"https://circleci.com/\">Circle CI</a> è¿™æ ·çš„æŒç»­é›†æˆæœåŠ¡ï¼Œ æ˜¯ç”± GitHub å®˜æ–¹æ¨å‡ºçš„æŒç»­é›†æˆæœåŠ¡ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆä¸€äº›è‡ªåŠ¨åŒ–æµ‹è¯•ã€æ‰“åŒ…ã€éƒ¨ç½²ç­‰æ“ä½œã€‚</p>\n<p>GitHub Actions ä¸­çš„å¸¸è§æœ¯è¯­:</p>\n<ul>\n<li><code>workflow</code> è¡¨ç¤ºä¸€æ¬¡æŒç»­é›†æˆçš„è¿‡ç¨‹</li>\n<li><code>job</code> è¡¨ç¤ºæ„å»ºä»»åŠ¡ï¼Œä¸€ä¸ª workflow å¯ä»¥ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ª job ç»„æˆï¼Œå¯æ”¯æŒå¹¶å‘æ‰§è¡Œå¤šä¸ª job</li>\n<li><code>step</code> ä¸€ä¸ª job ç”±ä¸€ä¸ªæˆ–å¤šä¸ª step ç»„æˆï¼ŒæŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œ</li>\n<li><code>action</code> æ¯ä¸ª step ç”±ä¸€ä¸ªæˆ–å¤šä¸ª action ç»„æˆï¼ŒæŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œ</li>\n</ul>\n<br />\n\n<p><strong>å®˜æ–¹æ–‡æ¡£ï¼š</strong></p>\n<ul>\n<li><a href=\"https://help.github.com/en/actions\">https://help.github.com/en/actions</a> (English)</li>\n<li><a href=\"https://help.github.com/cn/actions\">https://help.github.com/cn/actions</a> (ä¸­æ–‡)</li>\n</ul>\n<h2 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h2><p>åˆ›å»ºä¸€ä¸ª <code>username.github.io</code> çš„ä»“åº“ï¼Œ <code>username</code> ä¸ºè‡ªå·± GitHub çš„ç”¨æˆ·åï¼Œåœ¨è¿™ä¸ªä»“åº“ä¸­é‡‡ç”¨çš„ä¸€ä¸ªä»“åº“å¤šåˆ†æ”¯çš„æ–¹å¼ï¼Œä¸€ä¸ªåˆ†æ”¯å­˜æ”¾åšå®¢æºç ï¼Œä¸»åˆ†æ”¯ç”¨æ¥å­˜æ”¾ç”Ÿæˆçš„ç½‘ç«™é™æ€èµ„æºã€‚</p>\n<h3 id=\"GitHub-ç§˜é’¥é…ç½®\"><a href=\"#GitHub-ç§˜é’¥é…ç½®\" class=\"headerlink\" title=\"GitHub ç§˜é’¥é…ç½®\"></a>GitHub ç§˜é’¥é…ç½®</h3><p>ä½¿ç”¨å‘½ä»¤ç”Ÿæˆç§˜é’¥ï¼šè¯¥å‘½ä»¤ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼Œ åˆ†åˆ«ä¸ºå…¬é’¥ <code>github-deploy-key.pub</code> å’Œç§é’¥ <code>github-deploy-key</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">ssh-keygen -f github-deploy-key<br></code></pre></td></tr></table></figure>\n\n<p>å°†åˆ›å»ºå¥½çš„ <code>github-deploy-key.pub</code> æ–‡ä»¶ä¸­çš„å†…å®¹å¤åˆ¶æ·»åŠ åˆ°å¯¹åº”ä»“åº“çš„ Deploy keys ä¸­ï¼Œ <strong>Settings</strong> &#x2F; <strong>Deploy keys</strong> &#x2F; <strong>Add deploy key</strong>ï¼Œ å–åä¸º <code>HEXO_DEPLOY_KEY_PUB</code>ã€‚</p>\n<p><img  src=\"https://z3.ax1x.com/2020/12/24/rc4kxx.png\"   loading=\"lazy\"><span class=\"image-caption\">HEXO_DEPLOY_KEY_PUB</span></p>\n<p>å°†åˆ›å»ºå¥½çš„ <code>github-deploy-key</code> æ–‡ä»¶ä¸­çš„å†…å®¹å¤åˆ¶æ·»åŠ åˆ°å¯¹åº”ä»“åº“çš„ Secrets ä¸­ï¼Œ <strong>Settings</strong> &#x2F; <strong>Secrets</strong> &#x2F; <strong>New Secret</strong>ï¼Œå–åä¸º <code>HEXO_DEPLOY_KEY_PRI</code>ã€‚</p>\n<p><img  src=\"https://z3.ax1x.com/2020/12/24/rc4Mid.png\"   loading=\"lazy\"><span class=\"image-caption\">HEXO_DEPLOY_KEY_PRI</span></p>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œå–çš„åå­—åœ¨ Actions è„šæœ¬ä¸­é€šè¿‡ <code>$&#123;&#123;secrets.HEXO_DEPLOY_KEY_PRI&#125;&#125;</code> è·å–æ—¶éœ€è¦ä¸€è‡´ã€‚</p>\n<h2 id=\"Github-Actions-è„šæœ¬ç¼–å†™\"><a href=\"#Github-Actions-è„šæœ¬ç¼–å†™\" class=\"headerlink\" title=\"Github Actions è„šæœ¬ç¼–å†™\"></a>Github Actions è„šæœ¬ç¼–å†™</h2><p>åœ¨ä»“åº“çš„ <code>.github/workflows/</code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª <code>hexo-auto-deploy-ci.yml</code> æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åå­—å¯ä»¥æ˜¯éšæ„å–å¾—ã€‚</p>\n<p>æˆ‘çš„ Actions è„šæœ¬é…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yml\"><span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Hexo</span> <span class=\"hljs-string\">Auto</span> <span class=\"hljs-string\">Deploy</span> <span class=\"hljs-string\">CI</span><br><br><span class=\"hljs-attr\">on:</span><br>  <span class=\"hljs-attr\">push:</span><br>    <span class=\"hljs-attr\">branches:</span> [<span class=\"hljs-string\">source</span>]<br>  <span class=\"hljs-attr\">pull_request:</span><br>    <span class=\"hljs-attr\">branches:</span> [<span class=\"hljs-string\">source</span>]<br><br><span class=\"hljs-attr\">env:</span><br>  <span class=\"hljs-attr\">GIT_USER:</span> <span class=\"hljs-string\">iaosee</span><br>  <span class=\"hljs-attr\">GIT_EMAIL:</span> <span class=\"hljs-string\">iaosee@outlook.com</span><br>  <span class=\"hljs-attr\">THEME_REPO:</span> <span class=\"hljs-string\">iaosee/hexo-theme-zhaoo</span><br>  <span class=\"hljs-attr\">THEME_BRANCH:</span> <span class=\"hljs-string\">master</span><br><br><span class=\"hljs-attr\">jobs:</span><br>  <span class=\"hljs-attr\">build:</span><br>    <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Build</span> <span class=\"hljs-string\">on</span> <span class=\"hljs-string\">node</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">matrix.node_version</span> <span class=\"hljs-string\">&#125;&#125;</span> <span class=\"hljs-string\">and</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">matrix.os</span> <span class=\"hljs-string\">&#125;&#125;</span><br>    <span class=\"hljs-attr\">runs-on:</span> <span class=\"hljs-string\">ubuntu-latest</span><br>    <span class=\"hljs-attr\">strategy:</span><br>      <span class=\"hljs-attr\">matrix:</span><br>        <span class=\"hljs-attr\">os:</span> [<span class=\"hljs-string\">ubuntu-latest</span>]<br>        <span class=\"hljs-attr\">node_version:</span> [<span class=\"hljs-number\">12.</span><span class=\"hljs-string\">x</span>]<br><br>    <span class=\"hljs-attr\">steps:</span><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">blog</span> <span class=\"hljs-string\">repo</span><br>        <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v2</span><br>        <span class=\"hljs-attr\">with:</span><br>          <span class=\"hljs-attr\">ref:</span> <span class=\"hljs-string\">source</span><br><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">theme</span> <span class=\"hljs-string\">repo</span><br>        <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v2</span><br>        <span class=\"hljs-attr\">with:</span><br>          <span class=\"hljs-attr\">repository:</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">env.THEME_REPO</span> <span class=\"hljs-string\">&#125;&#125;</span><br>          <span class=\"hljs-attr\">ref:</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">env.THEME_BRANCH</span> <span class=\"hljs-string\">&#125;&#125;</span><br>          <span class=\"hljs-attr\">path:</span> <span class=\"hljs-string\">themes/zhaoo</span><br><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Use</span> <span class=\"hljs-string\">Node.js</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">matrix.node_version</span> <span class=\"hljs-string\">&#125;&#125;</span><br>        <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/setup-node@v1</span><br>        <span class=\"hljs-attr\">with:</span><br>          <span class=\"hljs-attr\">node-version:</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">matrix.node_version</span> <span class=\"hljs-string\">&#125;&#125;</span><br><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Configuration</span> <span class=\"hljs-string\">environment</span><br>        <span class=\"hljs-attr\">env:</span><br>          <span class=\"hljs-attr\">HEXO_DEPLOY_KEY_PRI:</span> <span class=\"hljs-string\">$&#123;&#123;secrets.HEXO_DEPLOY_KEY_PRI&#125;&#125;</span><br>        <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|</span><br><span class=\"hljs-string\">          sudo timedatectl set-timezone &quot;Asia/Shanghai&quot;</span><br><span class=\"hljs-string\">          mkdir -p ~/.ssh/</span><br><span class=\"hljs-string\">          echo &quot;$HEXO_DEPLOY_KEY_PRI&quot; &gt; ~/.ssh/id_rsa</span><br><span class=\"hljs-string\">          chmod 600 ~/.ssh/id_rsa</span><br><span class=\"hljs-string\">          ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts</span><br><span class=\"hljs-string\">          git config --global user.name $GIT_USER</span><br><span class=\"hljs-string\">          git config --global user.email $GIT_EMAIL</span><br><span class=\"hljs-string\"></span><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Install</span> <span class=\"hljs-string\">dependencies</span><br>        <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|</span><br><span class=\"hljs-string\">          npm i</span><br><span class=\"hljs-string\"></span><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Deploy</span> <span class=\"hljs-string\">blog</span><br>        <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|</span><br><span class=\"hljs-string\">          npm run clean</span><br><span class=\"hljs-string\">          npm run deploy</span><br></code></pre></td></tr></table></figure>\n\n\n<h3 id=\"è¿è¡Œè„šæœ¬\"><a href=\"#è¿è¡Œè„šæœ¬\" class=\"headerlink\" title=\"è¿è¡Œè„šæœ¬\"></a>è¿è¡Œè„šæœ¬</h3><p>ç°åœ¨ï¼Œåªè¦ä»“åº“çš„ <code>source</code> åˆ†æ”¯æœ‰ä»£ç æ¨é€ï¼ŒGitHub å°±ä¼šåˆ›å»ºä¸€ä¸ªå®¹å™¨æ¥è¿è¡Œè¿™é‡Œé…ç½®çš„ä»»åŠ¡ï¼Œè§£æ”¾åŒæ‰‹ï¼ŒEnjoy It ğŸ˜ƒã€‚</p>\n<p><img  src=\"https://z3.ax1x.com/2020/12/24/rc4UoQ.png\"   loading=\"lazy\"><span class=\"image-caption\">Actions è„šæœ¬è¿è¡Œç»“æœ</span></p>\n","more":"<h2 id=\"ä»‹ç»\"><a href=\"#ä»‹ç»\" class=\"headerlink\" title=\"ä»‹ç»\"></a>ä»‹ç»</h2><p>è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹ä½¿ç”¨ GitHub Actions ä¸€æ­¥ä¸€æ­¥å®ç° <a href=\"https://hexo.io/\">Hexo Blog</a> è‡ªåŠ¨åŒ–æ„å»ºéƒ¨ç½²åˆ° GitHub Pages çš„æµç¨‹ã€‚</p>\n<p><a href=\"https://docs.github.com/cn/free-pro-team@latest/actions\">GitHub Actions</a> æ˜¯ç±»ä¼¼äº <a href=\"https://travis-ci.org/\">Travis CI</a> ã€ <a href=\"https://circleci.com/\">Circle CI</a> è¿™æ ·çš„æŒç»­é›†æˆæœåŠ¡ï¼Œ æ˜¯ç”± GitHub å®˜æ–¹æ¨å‡ºçš„æŒç»­é›†æˆæœåŠ¡ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆä¸€äº›è‡ªåŠ¨åŒ–æµ‹è¯•ã€æ‰“åŒ…ã€éƒ¨ç½²ç­‰æ“ä½œã€‚</p>\n<p>GitHub Actions ä¸­çš„å¸¸è§æœ¯è¯­:</p>\n<ul>\n<li><code>workflow</code> è¡¨ç¤ºä¸€æ¬¡æŒç»­é›†æˆçš„è¿‡ç¨‹</li>\n<li><code>job</code> è¡¨ç¤ºæ„å»ºä»»åŠ¡ï¼Œä¸€ä¸ª workflow å¯ä»¥ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ª job ç»„æˆï¼Œå¯æ”¯æŒå¹¶å‘æ‰§è¡Œå¤šä¸ª job</li>\n<li><code>step</code> ä¸€ä¸ª job ç”±ä¸€ä¸ªæˆ–å¤šä¸ª step ç»„æˆï¼ŒæŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œ</li>\n<li><code>action</code> æ¯ä¸ª step ç”±ä¸€ä¸ªæˆ–å¤šä¸ª action ç»„æˆï¼ŒæŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œ</li>\n</ul>\n<br />\n\n<p><strong>å®˜æ–¹æ–‡æ¡£ï¼š</strong></p>\n<ul>\n<li><a href=\"https://help.github.com/en/actions\">https://help.github.com/en/actions</a> (English)</li>\n<li><a href=\"https://help.github.com/cn/actions\">https://help.github.com/cn/actions</a> (ä¸­æ–‡)</li>\n</ul>\n<h2 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h2><p>åˆ›å»ºä¸€ä¸ª <code>username.github.io</code> çš„ä»“åº“ï¼Œ <code>username</code> ä¸ºè‡ªå·± GitHub çš„ç”¨æˆ·åï¼Œåœ¨è¿™ä¸ªä»“åº“ä¸­é‡‡ç”¨çš„ä¸€ä¸ªä»“åº“å¤šåˆ†æ”¯çš„æ–¹å¼ï¼Œä¸€ä¸ªåˆ†æ”¯å­˜æ”¾åšå®¢æºç ï¼Œä¸»åˆ†æ”¯ç”¨æ¥å­˜æ”¾ç”Ÿæˆçš„ç½‘ç«™é™æ€èµ„æºã€‚</p>\n<h3 id=\"GitHub-ç§˜é’¥é…ç½®\"><a href=\"#GitHub-ç§˜é’¥é…ç½®\" class=\"headerlink\" title=\"GitHub ç§˜é’¥é…ç½®\"></a>GitHub ç§˜é’¥é…ç½®</h3><p>ä½¿ç”¨å‘½ä»¤ç”Ÿæˆç§˜é’¥ï¼šè¯¥å‘½ä»¤ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼Œ åˆ†åˆ«ä¸ºå…¬é’¥ <code>github-deploy-key.pub</code> å’Œç§é’¥ <code>github-deploy-key</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">ssh-keygen -f github-deploy-key<br></code></pre></td></tr></table></figure>\n\n<p>å°†åˆ›å»ºå¥½çš„ <code>github-deploy-key.pub</code> æ–‡ä»¶ä¸­çš„å†…å®¹å¤åˆ¶æ·»åŠ åˆ°å¯¹åº”ä»“åº“çš„ Deploy keys ä¸­ï¼Œ <strong>Settings</strong> &#x2F; <strong>Deploy keys</strong> &#x2F; <strong>Add deploy key</strong>ï¼Œ å–åä¸º <code>HEXO_DEPLOY_KEY_PUB</code>ã€‚</p>\n<p><img  src=\"https://z3.ax1x.com/2020/12/24/rc4kxx.png\"   loading=\"lazy\"><span class=\"image-caption\">HEXO_DEPLOY_KEY_PUB</span></p>\n<p>å°†åˆ›å»ºå¥½çš„ <code>github-deploy-key</code> æ–‡ä»¶ä¸­çš„å†…å®¹å¤åˆ¶æ·»åŠ åˆ°å¯¹åº”ä»“åº“çš„ Secrets ä¸­ï¼Œ <strong>Settings</strong> &#x2F; <strong>Secrets</strong> &#x2F; <strong>New Secret</strong>ï¼Œå–åä¸º <code>HEXO_DEPLOY_KEY_PRI</code>ã€‚</p>\n<p><img  src=\"https://z3.ax1x.com/2020/12/24/rc4Mid.png\"   loading=\"lazy\"><span class=\"image-caption\">HEXO_DEPLOY_KEY_PRI</span></p>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œå–çš„åå­—åœ¨ Actions è„šæœ¬ä¸­é€šè¿‡ <code>$&#123;&#123;secrets.HEXO_DEPLOY_KEY_PRI&#125;&#125;</code> è·å–æ—¶éœ€è¦ä¸€è‡´ã€‚</p>\n<h2 id=\"Github-Actions-è„šæœ¬ç¼–å†™\"><a href=\"#Github-Actions-è„šæœ¬ç¼–å†™\" class=\"headerlink\" title=\"Github Actions è„šæœ¬ç¼–å†™\"></a>Github Actions è„šæœ¬ç¼–å†™</h2><p>åœ¨ä»“åº“çš„ <code>.github/workflows/</code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª <code>hexo-auto-deploy-ci.yml</code> æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åå­—å¯ä»¥æ˜¯éšæ„å–å¾—ã€‚</p>\n<p>æˆ‘çš„ Actions è„šæœ¬é…ç½®å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yml\"><span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Hexo</span> <span class=\"hljs-string\">Auto</span> <span class=\"hljs-string\">Deploy</span> <span class=\"hljs-string\">CI</span><br><br><span class=\"hljs-attr\">on:</span><br>  <span class=\"hljs-attr\">push:</span><br>    <span class=\"hljs-attr\">branches:</span> [<span class=\"hljs-string\">source</span>]<br>  <span class=\"hljs-attr\">pull_request:</span><br>    <span class=\"hljs-attr\">branches:</span> [<span class=\"hljs-string\">source</span>]<br><br><span class=\"hljs-attr\">env:</span><br>  <span class=\"hljs-attr\">GIT_USER:</span> <span class=\"hljs-string\">iaosee</span><br>  <span class=\"hljs-attr\">GIT_EMAIL:</span> <span class=\"hljs-string\">iaosee@outlook.com</span><br>  <span class=\"hljs-attr\">THEME_REPO:</span> <span class=\"hljs-string\">iaosee/hexo-theme-zhaoo</span><br>  <span class=\"hljs-attr\">THEME_BRANCH:</span> <span class=\"hljs-string\">master</span><br><br><span class=\"hljs-attr\">jobs:</span><br>  <span class=\"hljs-attr\">build:</span><br>    <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Build</span> <span class=\"hljs-string\">on</span> <span class=\"hljs-string\">node</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">matrix.node_version</span> <span class=\"hljs-string\">&#125;&#125;</span> <span class=\"hljs-string\">and</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">matrix.os</span> <span class=\"hljs-string\">&#125;&#125;</span><br>    <span class=\"hljs-attr\">runs-on:</span> <span class=\"hljs-string\">ubuntu-latest</span><br>    <span class=\"hljs-attr\">strategy:</span><br>      <span class=\"hljs-attr\">matrix:</span><br>        <span class=\"hljs-attr\">os:</span> [<span class=\"hljs-string\">ubuntu-latest</span>]<br>        <span class=\"hljs-attr\">node_version:</span> [<span class=\"hljs-number\">12.</span><span class=\"hljs-string\">x</span>]<br><br>    <span class=\"hljs-attr\">steps:</span><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">blog</span> <span class=\"hljs-string\">repo</span><br>        <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v2</span><br>        <span class=\"hljs-attr\">with:</span><br>          <span class=\"hljs-attr\">ref:</span> <span class=\"hljs-string\">source</span><br><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">theme</span> <span class=\"hljs-string\">repo</span><br>        <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v2</span><br>        <span class=\"hljs-attr\">with:</span><br>          <span class=\"hljs-attr\">repository:</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">env.THEME_REPO</span> <span class=\"hljs-string\">&#125;&#125;</span><br>          <span class=\"hljs-attr\">ref:</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">env.THEME_BRANCH</span> <span class=\"hljs-string\">&#125;&#125;</span><br>          <span class=\"hljs-attr\">path:</span> <span class=\"hljs-string\">themes/zhaoo</span><br><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Use</span> <span class=\"hljs-string\">Node.js</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">matrix.node_version</span> <span class=\"hljs-string\">&#125;&#125;</span><br>        <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/setup-node@v1</span><br>        <span class=\"hljs-attr\">with:</span><br>          <span class=\"hljs-attr\">node-version:</span> <span class=\"hljs-string\">$&#123;&#123;</span> <span class=\"hljs-string\">matrix.node_version</span> <span class=\"hljs-string\">&#125;&#125;</span><br><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Configuration</span> <span class=\"hljs-string\">environment</span><br>        <span class=\"hljs-attr\">env:</span><br>          <span class=\"hljs-attr\">HEXO_DEPLOY_KEY_PRI:</span> <span class=\"hljs-string\">$&#123;&#123;secrets.HEXO_DEPLOY_KEY_PRI&#125;&#125;</span><br>        <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|</span><br><span class=\"hljs-string\">          sudo timedatectl set-timezone &quot;Asia/Shanghai&quot;</span><br><span class=\"hljs-string\">          mkdir -p ~/.ssh/</span><br><span class=\"hljs-string\">          echo &quot;$HEXO_DEPLOY_KEY_PRI&quot; &gt; ~/.ssh/id_rsa</span><br><span class=\"hljs-string\">          chmod 600 ~/.ssh/id_rsa</span><br><span class=\"hljs-string\">          ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts</span><br><span class=\"hljs-string\">          git config --global user.name $GIT_USER</span><br><span class=\"hljs-string\">          git config --global user.email $GIT_EMAIL</span><br><span class=\"hljs-string\"></span><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Install</span> <span class=\"hljs-string\">dependencies</span><br>        <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|</span><br><span class=\"hljs-string\">          npm i</span><br><span class=\"hljs-string\"></span><br>      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Deploy</span> <span class=\"hljs-string\">blog</span><br>        <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">|</span><br><span class=\"hljs-string\">          npm run clean</span><br><span class=\"hljs-string\">          npm run deploy</span><br></code></pre></td></tr></table></figure>\n\n\n<h3 id=\"è¿è¡Œè„šæœ¬\"><a href=\"#è¿è¡Œè„šæœ¬\" class=\"headerlink\" title=\"è¿è¡Œè„šæœ¬\"></a>è¿è¡Œè„šæœ¬</h3><p>ç°åœ¨ï¼Œåªè¦ä»“åº“çš„ <code>source</code> åˆ†æ”¯æœ‰ä»£ç æ¨é€ï¼ŒGitHub å°±ä¼šåˆ›å»ºä¸€ä¸ªå®¹å™¨æ¥è¿è¡Œè¿™é‡Œé…ç½®çš„ä»»åŠ¡ï¼Œè§£æ”¾åŒæ‰‹ï¼ŒEnjoy It ğŸ˜ƒã€‚</p>\n<p><img  src=\"https://z3.ax1x.com/2020/12/24/rc4UoQ.png\"   loading=\"lazy\"><span class=\"image-caption\">Actions è„šæœ¬è¿è¡Œç»“æœ</span></p>\n","categories":[{"name":"CI/CD","path":"api/categories/CI/CD.json"}],"tags":[{"name":"CI/CD","path":"api/tags/CI/CD.json"},{"name":"GitHub Actions","path":"api/tags/GitHub Actions.json"}]}